---
layout: post
title: "Начал раскуривать kickstart"
date: '2014-12-25 11:37:50'
---

Есть такая клёвая штука от redhat, которая появилась ещё до того как chef и vagrant стали модными. Называется она kickstart и нужна чтобы автоматизировать установку RHEL / CentOS на железо.

## Пишем конфиг
Писать конфиг в оригинале рекомендуется с помощью kickstart configurator (в ubuntu пакет зовётся system-config-kickstart). Но допиливать ручками его потом всё равно придётся, скорее всего. Вот то, что получилось у меня:

    #Generated by Kickstart Configurator
    #platform=x86_64

    #System language
    lang ru_RU
    keyboard us
    
    #System timezone
    timezone Europe/Moscow
    #Root password
    rootpw --iscrypted $1$w3JEJOMG$IUpdsYLUAd48SJ2F4zVXt1
    #Reboot after installation
    reboot
    #Use text mode install
    text
    #Install OS instead of upgrade
    install
    
    #System bootloader configuration
    bootloader --location=mbr --append panic=10 selinux=0 rd_NO_LVM rd_NO_DM 
    #Clear the Master Boot Record
    zerombr yes
    
    #Partition clearing information
    clearpart --all --initlabel 

	#Disk partitioning information
    part / --fstype ext4 --size 4000 --asprimary 
    part /app --fstype ext4 --size 8000
    part /mnt/log/ --fstype ext4 --size 700
    part /mnt/etc/ --fstype ext4 --size 700
    part /mnt/bk/ --fstype ext4 --size 500
    part /mnt/var/ --fstype ext4 --size 100
    part swap --recommended 

    #System authorization infomation
    auth  --useshadow  --enablemd5 
    #Firewall configuration
    firewall --disabled --ssh 
    #Do not configure the X Window System
    skipx

## Действия при установке

Загрузившись с компашки осталось сделать совсем немного: нажать TAB и дописать пару опций в параметры загрузки, вот мой пример:

	ks=http://genacid.ru:1488/static/ks.cfg ksdevice=eth0 ip=10.901.40.38 netmask=255.255.0.0 gateway=10.90.1.1 dns=10.90.1.1
    
После установки меня ждал приятный сюрприз - настройки сети были заболтливо сохранены и сразу после завершения установки я уже мог подключиться к виртуалке по ssh.